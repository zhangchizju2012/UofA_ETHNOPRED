#ifndef ETHNOPRED_SYSTEM
#define ETHNOPRED_SYSTEM
#include "Common.hpp"
namespace ETHNOPRED {
  namespace IO {
    typedef std::vector<std::vector<std::string>> VVS;
    typedef std::vector<std::string> VS;

    VVS analysisCSVFile(const char * fileName){
    	VVS myvectorinitial;
    	myvectorinitial.resize(2);
    	VVS myvector;
    	myvector.resize(2);
    	std::ifstream file;
    	std::stringstream ss;
    	std::string str;
    	file.exceptions(std::ifstream::failbit | std::ifstream::badbit);

    	try {
    		file.open(fileName);
    		ss << file.rdbuf();
    		str = ss.str();
    		file.close();
    	}
    	catch (std::ifstream::failure e) {
    		std::cerr << "Exception opening file\n" << e.what() << std::endl;
    		exit(1);
    	}

    	std::string delimiter = ",";
    	std::string linebreak = "\n";
    	std::string line1;
    	std::string line2;
    	std::string lineID;
    	std::string lineInfo;

    	size_t breakPos = str.find(linebreak);
    	line1 = str.substr(0, breakPos + linebreak.length());
    	str = str.erase(0, breakPos + linebreak.length());
    	breakPos = str.find(linebreak);
    	line2 = str.substr(0, breakPos + linebreak.length());
      //Euro 15 trees
      //std::string SNPId = "rs3131972,rs3748592,rs13303010,rs9697457,rs35940137,rs2710875,rs9442380,rs10907175,rs11721,rs35134975,rs873927,rs28456011,rs752965,rs6663158,rs1878752,rs4648843,rs11590198,rs4648451,rs16824089,rs12756705,rs12411035,rs4654598,rs11591221,rs7537345,rs10915671,rs2649071,rs12061902,rs12084067,rs7540503,rs4243830,rs12754538,rs11121374,rs4129341,rs2924863,rs16853148,rs1737352,rs11582182,rs1192579,rs2744705,rs9426362,rs6425820,rs2492301,rs2788031,rs17123422,rs1772618,rs11208566,rs9729825,rs17099679,rs1333717,rs41453452,rs10494252,rs1027423,rs164151,rs2015330,rs16865298,rs1496092,rs1772145,rs17048875,rs3890758,rs2671264,rs7419176,rs4853793,rs4952541,rs13396777,rs12466764,rs11694681,rs1031466,rs3791298,rs1942055,rs7599054,rs6430545,rs1446523,rs1530559,rs4954218,rs7570971,rs12988076,rs6719488,rs4988235,rs309180,rs218174,rs309160,rs309164,rs12615624,rs687670,rs309134,rs309137,rs4954557,rs11693502,rs749873,rs932206,rs4954573,rs7568884,rs11692725,rs10204606,rs11687599,rs10803574,rs2890917,rs13005337,rs1485973,rs1453406,rs10172873,rs12053389,rs17255817,rs3828267,rs4666782,rs13431857,rs1016569,rs16827500,rs10510366,rs1126098,rs615861,rs4292253,rs3773540,rs17404744,rs16849564,rs1356359,rs17786823,rs35936034,rs17018796,rs17040162,rs17040164,rs6846249,rs13143297,rs1565469,rs13150320,rs6552970,rs154160,rs17602783,rs12109110,rs12654448,rs1419644,rs439812,rs1318631,rs2395634,rs6904956,rs7740421,rs10245230,rs12690925,rs10096219,rs10113325,rs10888101,rs1481742,rs1401817,rs6998565,rs272613,rs1355640,rs2418249,rs4880987,rs11252318,rs12259741,rs1249402,rs11008809,rs760336,rs7911308,rs11602585,rs2595448,rs7395373,rs659944,rs721346,rs2283293,rs11831618,rs1871549,rs265638,rs7966178,rs7981968,rs540497,rs17091427,rs9788522,rs7168653,rs1002007,rs12905660,rs16973728,rs299955,rs4799085,rs6052070,rs6029050,rs16980843,rs233253,rs461436,rs5754554,\n";
      //NorthAmerican 12 trees
      //std::string SNPId = "rs3131972,rs2905036,rs4245756,rs4970383,rs4475691,rs13302982,rs4040604,rs3748592,rs3748593,rs28570376,rs6696281,rs35940137,rs9331225,rs9803031,rs6667248,rs4314833,rs9729550,rs11466691,rs6603781,rs6685064,rs3737721,rs3737718,rs2274264,rs12142199,rs3855955,rs17160669,rs35242196,rs1240708,rs873927,rs35958305,rs7290,rs3766178,rs3128342,rs1926883,rs7407,rs2281173,rs2235536,rs2254669,rs4648808,rs425277,rs9442619,rs2292857,rs262680,rs10910034,rs2643885,rs2055204,rs2840530,rs4310388,rs10752748,rs2606411,rs6681741,rs2817185,rs1798246,rs2651927,rs2651912,rs2500283,rs12043519,rs2483275,rs2244013,rs6669870,rs2298225,rs12039666,rs10492944,rs7541544,rs351619,rs17348860,rs3947662,rs367673,rs13376100,rs9329417,rs973978,rs6577401,rs7517585,rs11120943,rs17031150,rs9919220,rs679563,rs11582339,rs3860318,rs11121722,rs1881559,rs1569635,rs9442235,rs638425,rs41388954,rs10737480,rs10917234,rs12410046,rs12075715,rs3767908,rs1335762,rs2183746,rs12097368,rs1498111,rs522821,rs3795501,rs274751,rs11264025,rs1861,rs11211329,rs12028663,rs12038297,rs7552342,rs3737829,rs2793661,rs10889634,rs12059795,rs12411125,rs6694203,rs11204853,rs16841094,rs2814778,rs7552141,rs4644548,rs6663420,rs1246828,rs488612,rs2802774,rs12568035,rs11119881,rs1439464,rs17742354,rs6541124,rs16846854,rs12467317,rs672463,rs4669937,rs1524007,rs10165208,rs7588439,rs1396795,rs1396797,rs6732285,rs4851370,rs2123694,rs13397666,rs260698,rs7582192,rs164736,rs2059696,rs10173594,rs6717424,rs1858104,rs6731591,rs4668272,rs1865164,rs17027638,rs5004864,rs6445254,rs2083838,rs11707443,rs1374821,rs4678073,rs6439472,rs6804194,rs16870076,rs210780,rs12108234,rs10008032,rs5743567,rs4833103,rs4624679,rs17007466,rs10025344,rs11748410,rs609096,rs2303170,rs35389,rs35391,rs28117,rs35411,rs1363845,rs331728,rs2270068,rs3776337,rs3776334,rs3776329,rs4958560,rs6932667,rs2051548,rs2691483,rs9442996,rs7759248,rs1016101,rs1338839,rs4870227,rs17084501,rs11965097,rs7782345,rs1465221,rs10245220,rs2904664,rs310373,rs1384182,rs4871389,rs10969597,rs10961635,rs7860104,rs10962599,rs2891125,rs12685829,rs715846,rs1888913,rs2377982,rs10749549,rs3814226,rs11192637,rs11198214,rs3213221,rs10835271,rs12294859,rs4930431,rs7134749,rs2519,rs12423495,rs10777469,rs1007916,rs16941717,rs692902,rs2292051,rs13378757,rs11147417,rs17640978,rs12875618,rs9573246,rs9557355,rs17128262,rs7154864,rs8007618,rs12590812,rs926144,rs4906743,rs1800414,rs11636232,rs916977,rs12595731,rs1704348,rs3848147,rs11637114,rs4436808,rs8053650,rs1133238,rs2032915,rs6500380,rs4790359,rs7214357,rs220486,rs8081204,rs9907225,rs4968239,rs9893667,rs9896466,rs8078633,rs911445,rs6053122,rs6038071,rs2039242,rs2829003,rs4819094,rs917408,rs738989,rs17425081,rs12484869,rs1960182,rs5751131,rs5758402,\n";
      //African 22 trees
    	//std::string SNPId = "rs12124819,rs2905036,rs4245756,rs6694982,rs17160698,rs28499371,rs6696281,rs28391282,rs3128117,rs9697358,rs9331225,rs9803031,rs6667248,rs11807848,rs12757754,rs2298217,rs9660710,rs10907175,rs1815606,rs11466673,rs3813199,rs11260562,rs11260568,rs1739855,rs3737718,rs12142199,rs3845293,rs17160975,rs36044796,rs9782908,rs11807706,rs3128342,rs2377417,rs7520934,rs4648764,rs7531583,rs9970652,rs752965,rs2459994,rs3107145,rs427811,rs9442619,rs1713712,rs10910061,rs12033324,rs903903,rs1123571,rs2494640,rs11581548,rs7512269,rs2477703,rs2477707,rs2147905,rs2234167,rs10910097,rs897620,rs880724,rs2842909,rs2817178,rs1798246,rs10492940,rs2500297,rs12086132,rs6687835,rs1333190,rs870171,rs4648501,rs2493314,rs4648524,rs2821059,rs2794320,rs7514979,rs2298223,rs12079672,rs12090228,rs17404600,rs12093951,rs10915424,rs10915430,rs4130091,rs12071761,rs1353341,rs589870,rs6660514,rs616317,rs242058,rs242050,rs12408533,rs4654607,rs12124406,rs11584727,rs6426370,rs3128689,rs6690311,rs16840287,rs11808981,rs2071958,rs9659669,rs11805412,rs2153900,rs17027039,rs4845820,rs12122894,rs9434795,rs2693958,rs17376559,rs11121090,rs11584036,rs6684149,rs935073,rs2982364,rs10864504,rs7534387,rs6419478,rs11807931,rs816060,rs12405691,rs17038427,rs10754901,rs16853407,rs3817958,rs12409852,rs6691985,rs619345,rs1031567,rs542634,rs525448,rs881247,rs11573205,rs10916790,rs8064,rs3795845,rs641347,rs12067378,rs12040683,rs3935892,rs10799032,rs28495286,rs16824722,rs967094,rs6671001,rs2057969,rs10890311,rs1258010,rs2758735,rs17104047,rs212989,rs6668399,rs7515087,rs4926853,rs7536376,rs542727,rs11808336,rs552006,rs12025026,rs6657290,rs6700924,rs316671,rs615739,rs12097782,rs925192,rs4847372,rs2064662,rs12074249,rs12039907,rs3017627,rs11102559,rs6665912,rs4845735,rs6427184,rs11265070,rs2808651,rs485618,rs12135523,rs12136407,rs16853992,rs1417592,rs9650996,rs7534913,rs7536226,rs12758773,rs3789052,rs12058761,rs3795521,rs6659655,rs10864120,rs1776037,rs7538397,rs12141832,rs6682184,rs6685066,rs12463789,rs1389583,rs771307,rs10204491,rs16866638,rs13414905,rs16862376,rs6734731,rs7590763,rs10198116,rs41513050,rs1067344,rs9789429,rs12478385,rs7596776,rs1534110,rs7600669,rs6731365,rs11125815,rs17030159,rs6547187,rs2309582,rs4851391,rs13389290,rs17030353,rs2034357,rs12620050,rs404499,rs17044602,rs4142753,rs17007536,rs2082331,rs7589010,rs12614459,rs1446750,rs842361,rs16855615,rs4954207,rs6742013,rs7605229,rs1042712,rs309172,rs309161,rs7573555,rs309143,rs6430594,rs309154,rs10205050,rs6755409,rs13403738,rs6759948,rs4894197,rs2562831,rs1427150,rs6734110,rs1607345,rs16849099,rs10932521,rs1443670,rs6436964,rs11688448,rs1995209,rs13087319,rs12630974,rs17729838,rs6785796,rs11718932,rs422584,rs385521,rs9851767,rs6807580,rs12487340,rs11711134,rs3749388,rs1995236,rs6446241,rs4928007,rs4683973,rs2325037,rs16838604,rs349558,rs7649861,rs6770324,rs1546260,rs10513545,rs6778401,rs16848617,rs6779590,rs13081915,rs10428090,rs16855847,rs1039027,rs9290610,rs6800015,rs1374808,rs10937252,rs16862821,rs9290877,rs2378559,rs2185886,rs1000647,rs968365,rs6854453,rs7686272,rs13137543,rs7674434,rs11544855,rs1901747,rs7669018,rs17089059,rs10028900,rs10022017,rs11735775,rs6854417,rs388401,rs6848616,rs12502827,rs4235448,rs4699030,rs17042596,rs17532826,rs17048953,rs6854489,rs345981,rs544870,rs1459157,rs10461322,rs11943281,rs316598,rs1393117,rs2658083,rs852619,rs7730689,rs2388044,rs17595719,rs16901558,rs6882064,rs2913276,rs17301591,rs4513668,rs7700264,rs6595775,rs2624459,rs7446054,rs2227282,rs2237059,rs803137,rs17646556,rs17171218,rs7728894,rs309331,rs17108678,rs17450822,rs7739132,rs2753922,rs6456890,rs1233320,rs2535340,rs1793891,rs12191877,rs367645,rs12191891,rs6932992,rs11963526,rs12204275,rs7741503,rs9486141,rs4245542,rs12191383,rs1204826,rs4946158,rs9400909,rs7753502,rs10872503,rs9376452,rs11155161,rs16900601,rs12701555,rs699486,rs1409968,rs10237182,rs17144015,rs4732511,rs11980955,rs6466823,rs6967965,rs11975980,rs7783639,rs6944302,rs1404315,rs10487094,rs10487999,rs17139871,rs1523794,rs11769723,rs4987672,rs13236792,rs1364519,rs4909055,rs532885,rs4841471,rs1356946,rs748596,rs1077052,rs7010861,rs6558059,rs7017705,rs17786140,rs1404756,rs218892,rs3039743,rs7010482,rs34065840,rs2272634,rs6477310,rs10429529,rs2025319,rs10971164,rs17210010,rs10867230,rs4878051,rs4242609,rs10992623,rs10818338,rs12005198,rs10819101,rs11564096,rs7039873,rs7390989,rs11257434,rs2815617,rs950220,rs1416801,rs9988744,rs10828213,rs824602,rs2839657,rs2370791,rs1935648,rs9421731,rs9415758,rs10825916,rs1536084,rs2182160,rs7923866,rs2476949,rs714816,rs2672609,rs11018181,rs10764918,rs7914354,rs10832430,rs10836370,rs7946936,rs11828501,rs11823218,rs8191431,rs12276848,rs11603486,rs10895512,rs6591090,rs1942518,rs542650,rs10501858,rs4366501,rs7316060,rs16910077,rs10492377,rs1601745,rs10785426,rs4344559,rs11836193,rs12305915,rs10748260,rs7295341,rs10847881,rs11060955,rs9575364,rs2951787,rs12561320,rs9597104,rs9583470,rs1407893,rs1956593,rs10140504,rs7155859,rs1051388,rs12897140,rs12885391,rs10137272,rs10498587,rs2373262,rs10873649,rs1679012,rs10454039,rs199138,rs1834640,rs7169337,rs7177754,rs1037041,rs8035628,rs8027920,rs8028686,rs8041403,rs4887382,rs9788651,rs8042942,rs2191430,rs4787040,rs2287198,rs1420676,rs1982394,rs7206635,rs16972211,rs8052388,rs8051251,rs17796342,rs7185017,rs17741623,rs11654128,rs2240099,rs34052864,rs8075137,rs8892,rs1241988,rs9953932,rs28464695,rs2230233,rs16949551,rs4605270,rs9958746,rs3106146,rs6422427,rs1725501,rs123187,rs11084467,rs4815694,rs3790221,rs6119337,rs6067491,rs6099216,rs2180698,rs354742,rs218336,rs11702338,rs3761364,rs965494,rs9975332,rs2839509,rs875060,rs417252,rs2023637,rs4819836,rs2270013,rs2040435,rs2267270,rs7284910,rs5999984,rs9619574,rs2227914,rs6007462,rs5770567,\n";
    	//Kenyan 31 trees
    	//std::string SNPId = "rs3131972,rs7537756,rs6694982,rs1110052,rs17160698,rs13303106,rs13303010,rs3935066,rs6696281,rs28504611,rs13303118,rs2341362,rs9697358,rs6667248,rs3766191,rs11260595,rs2298217,rs1320565,rs4314833,rs3813199,rs11260568,rs6685064,rs3737721,rs2274264,rs9782908,rs11552172,rs28635343,rs28707307,rs4648764,rs12069909,rs12742323,rs16824500,rs28625223,rs2803310,rs262656,rs2503701,rs7553178,rs4648819,rs12404555,rs1998759,rs10910099,rs12117343,rs12752801,rs6681741,rs2376821,rs2651906,rs3002685,rs6673393,rs11808276,rs947347,rs4431782,rs2181484,rs7523732,rs1175549,rs12031557,rs10915360,rs10753376,rs16838922,rs349400,rs3820250,rs392630,rs11799924,rs6671889,rs648378,rs12095221,rs7554078,rs11805516,rs4908925,rs11120876,rs12119558,rs6676442,rs2493214,rs67746,rs12022654,rs2744677,rs6429800,rs495937,rs7548984,rs16851168,rs9943244,rs7539166,rs4661748,rs1925704,rs4912106,rs897469,rs2776822,rs672138,rs4631721,rs17263039,rs7523842,rs477882,rs10890041,rs11210640,rs12145658,rs12085768,rs6697095,rs7527194,rs11208579,rs6424639,rs7415927,rs17369470,rs11583332,rs11166028,rs12064015,rs1772890,rs1844959,rs1597178,rs3125677,rs12059640,rs10908849,rs8177963,rs12739022,rs12069196,rs12135523,rs11586404,rs12722820,rs2284767,rs16863858,rs9660718,rs6424976,rs4651330,rs2488479,rs6428392,rs1125954,rs2359377,rs875044,rs12239056,rs1891231,rs445633,rs4658560,rs6677662,rs2551320,rs11884415,rs1534110,rs12994558,rs2061517,rs6731365,rs1005608,rs11125815,rs17030159,rs4233931,rs6760326,rs2861641,rs9309464,rs2190355,rs17754897,rs1595422,rs1545223,rs2241883,rs17048353,rs17044602,rs17047458,rs2315523,rs6735149,rs7586145,rs16855615,rs6742013,rs7605229,rs3806502,rs1050115,rs6724569,rs2015532,rs3769012,rs7581814,rs12472293,rs309172,rs7573555,rs309143,rs6430594,rs309154,rs10497029,rs4972277,rs6737636,rs7565410,rs6736379,rs6730036,rs1440463,rs5001924,rs985365,rs13404079,rs7561423,rs17202778,rs4142221,rs4674632,rs2058061,rs9832923,rs13319626,rs17298420,rs11916051,rs17226259,rs6794557,rs201729,rs936663,rs11915247,rs9874060,rs7653308,rs4269034,rs3935821,rs10001947,rs5743612,rs992133,rs17082523,rs9992661,rs17028457,rs12645079,rs1567049,rs13142580,rs1379602,rs316598,rs2188301,rs770308,rs9292857,rs2028723,rs10520997,rs16870510,rs6880683,rs10072084,rs973332,rs10474381,rs12188101,rs7710375,rs6862681,rs10075371,rs1366457,rs2227282,rs2237059,rs30534,rs17286578,rs312557,rs10075720,rs6556382,rs13162048,rs6458997,rs683966,rs6927023,rs364950,rs404557,rs9470872,rs7770679,rs11759220,rs1206088,rs12204275,rs6938518,rs7741503,rs7760662,rs9485572,rs7745739,rs17055737,rs4721216,rs699486,rs595541,rs6968676,rs2054788,rs6975220,rs1005032,rs1990796,rs10242455,rs4646457,rs776746,rs2740566,rs800672,rs6963345,rs4725499,rs17685410,rs4875671,rs2515542,rs532885,rs11203815,rs2237835,rs16937924,rs28399555,rs16886536,rs12541188,rs17775439,rs2720710,rs2944776,rs2721202,rs869939,rs16934647,rs10965215,rs7874475,rs1411088,rs13288508,rs4310281,rs1330684,rs4750058,rs17095806,rs7094900,rs7358097,rs1347957,rs11190458,rs809825,rs6584646,rs790660,rs2067022,rs704737,rs11547493,rs1792959,rs10792608,rs1399357,rs10897976,rs16923264,rs16905958,rs3103736,rs7136627,rs11176729,rs11842930,rs9576822,rs9516890,rs11618950,rs1956593,rs2415306,rs6572913,rs10137272,rs12885270,rs2373262,rs2430341,rs8027732,rs12438284,rs9745005,rs4402506,rs7168199,rs17241648,rs8057684,rs12601516,rs7216396,rs12943500,rs35487582,rs8070885,rs17823777,rs11660396,rs9953932,rs9948548,rs17086113,rs350130,rs2423334,rs1206810,rs6096853,rs6015825,rs8140370,rs5770567,\n";
    	//East Asian 47 trees
    	//std::string SNPId = "rs12124819,rs7537756,rs4040604,rs7523549,rs3935066,rs6694632,rs6665000,rs2465126,rs2465136,rs13129,rs7526076,rs9442372,rs3737728,rs2298217,rs4970421,rs11260542,rs9442387,rs12092254,rs1320565,rs9729550,rs11466691,rs6603781,rs6662635,rs1749951,rs17854636,rs182532,rs2765015,rs2291889,rs11488462,rs1571149,rs1887284,rs1926883,rs28414855,rs4648782,rs12748433,rs6699975,rs4074197,rs760925,rs1107910,rs7534617,rs9970652,rs12403351,rs28710181,rs4648745,rs10910029,rs10752741,rs4648805,rs4648807,rs16824860,rs12034613,rs7512482,rs16824948,rs2645072,rs2840531,rs10910061,rs1123571,rs4233033,rs1998759,rs11573979,rs11573970,rs10909872,rs1869972,rs2606414,rs16823350,rs6695131,rs926244,rs2651902,rs2651929,rs10797386,rs17398063,rs2455107,rs4648468,rs12073172,rs12119711,rs3765764,rs10910017,rs1885865,rs2275819,rs2298225,rs4131373,rs34835780,rs4654522,rs12023372,rs16840755,rs608210,rs10799255,rs16839450,rs4654468,rs1841241,rs10915307,rs2199215,rs2611423,rs10915396,rs7512133,rs12080410,rs12036857,rs770698,rs17028725,rs6698924,rs6577582,rs11120837,rs6656160,rs11120989,rs707457,rs178932,rs428180,rs12738365,rs17389948,rs7530465,rs284243,rs710139,rs12085319,rs17036706,rs2379143,rs11804222,rs12755560,rs10927559,rs164868,rs16850259,rs6685406,rs4920386,rs620950,rs1317209,rs3820330,rs11585587,rs904927,rs2119320,rs7540486,rs3893319,rs12090967,rs4654354,rs10914477,rs12136921,rs4652992,rs3768337,rs2660563,rs2209477,rs11538784,rs11580074,rs6671527,rs11211612,rs4131141,rs6694834,rs1288503,rs797913,rs4926684,rs2092595,rs2272052,rs686543,rs12561942,rs12063386,rs12760071,rs10493770,rs4101233,rs10159030,rs914958,rs7547028,rs662009,rs1074739,rs10494055,rs4244129,rs7542677,rs662353,rs17033865,rs4656248,rs2295615,rs2275603,rs4298709,rs17358956,rs863454,rs10913136,rs873525,rs7544659,rs12027396,rs6668819,rs6605005,rs16843306,rs2794860,rs11586974,rs10863308,rs2000319,rs1222144,rs2273939,rs487113,rs17140182,rs4846908,rs17599139,rs615625,rs12740262,rs7520258,rs10924366,rs4455137,rs953599,rs9287778,rs342136,rs7563543,rs17018699,rs6732743,rs12615002,rs919688,rs10460504,rs17737466,rs1914778,rs1421617,rs13414393,rs10865278,rs41385746,rs11126130,rs13432159,rs41374247,rs3771848,rs1517782,rs12467106,rs12104625,rs1845017,rs11127018,rs4580387,rs1376444,rs10168169,rs13014047,rs333859,rs333851,rs333846,rs4662834,rs6737431,rs12104489,rs4646329,rs10803583,rs10496977,rs374722,rs4662280,rs7587849,rs10176837,rs4530328,rs11677624,rs16826345,rs6717406,rs6732937,rs41471147,rs10932401,rs17325821,rs10933005,rs6436971,rs11563201,rs13387193,rs13392175,rs13030338,rs2320378,rs717187,rs1369407,rs1687331,rs4525889,rs1349283,rs13085028,rs7640543,rs17029445,rs34136796,rs13084153,rs11707193,rs13322517,rs7642488,rs1011609,rs6779452,rs12490963,rs16827628,rs1355781,rs13064974,rs931250,rs7626152,rs7644875,rs360710,rs191708,rs1511412,rs2348394,rs7640145,rs2133620,rs4680238,rs603638,rs3930233,rs1868150,rs751396,rs2713721,rs16864358,rs10804925,rs3889723,rs10517011,rs4371605,rs6833864,rs7658552,rs2173201,rs243996,rs4490524,rs6844821,rs2390135,rs1498016,rs10017946,rs1113111,rs17033938,rs10013441,rs17040351,rs412763,rs7687912,rs11132199,rs828316,rs6420051,rs31300,rs12697189,rs12658762,rs17783275,rs702552,rs10060821,rs379717,rs27433,rs13160949,rs10073882,rs7705687,rs7378826,rs17286171,rs17207681,rs17385747,rs2961739,rs6860288,rs6879391,rs17069519,rs11959012,rs1960425,rs4298263,rs315808,rs6886932,rs17676033,rs3756531,rs17075791,rs2036564,rs9504229,rs9328202,rs9328204,rs17137253,rs7760235,rs9502295,rs2432785,rs2503823,rs9379827,rs6940237,rs3757181,rs16895223,rs2860580,rs2975042,rs3130244,rs3749946,rs2261033,rs9277027,rs2567274,rs3117002,rs3130235,rs3130237,rs3116996,rs6901221,rs6901830,rs2499714,rs1398572,rs689391,rs4707130,rs485276,rs313243,rs1407448,rs6926826,rs6927568,rs10046248,rs13203813,rs3777997,rs211605,rs478611,rs9497981,rs9497982,rs17633478,rs742636,rs7767039,rs946236,rs372440,rs10244477,rs4637726,rs11770368,rs11974206,rs6971267,rs1035582,rs12532805,rs17680606,rs12534948,rs4617036,rs10240570,rs319870,rs2237551,rs953184,rs10500071,rs12532116,rs10954494,rs12698186,rs1670357,rs1900102,rs17150469,rs4840510,rs17120485,rs7016943,rs1351499,rs7832879,rs13251780,rs2439292,rs1994851,rs6472787,rs1869609,rs2513850,rs2622637,rs7461808,rs871952,rs12547611,rs2976392,rs2920297,rs2382019,rs1780160,rs4571809,rs1017783,rs12006467,rs10512019,rs12551119,rs1999462,rs3824405,rs6560612,rs7859023,rs4255200,rs2418268,rs2418269,rs1490742,rs3739477,rs10858363,rs17135476,rs11251966,rs2388746,rs17151786,rs7921121,rs12765118,rs11254106,rs10904962,rs11013746,rs3762084,rs1148214,rs2663018,rs2663027,rs1317894,rs4935397,rs4935640,rs17471932,rs12250707,rs12266901,rs16933163,rs7918954,rs1250544,rs12254574,rs2000177,rs1891275,rs12219674,rs12412736,rs10765099,rs11016442,rs8181588,rs2682107,rs443592,rs3741026,rs7944342,rs2268063,rs649640,rs10836933,rs12788223,rs11034713,rs7938730,rs1369323,rs7122010,rs1817653,rs4755957,rs4939526,rs7935178,rs640655,rs642490,rs11236209,rs4753962,rs770576,rs11224762,rs11224765,rs7928922,rs10895109,rs10444351,rs11224773,rs7935581,rs11224783,rs4141989,rs2046685,rs1791466,rs321125,rs1877351,rs2298464,rs4937070,rs4937384,rs12295314,rs2105606,rs11223548,rs10849181,rs3217805,rs3809250,rs10843585,rs1874799,rs2277317,rs6581191,rs1275569,rs11104775,rs1508594,rs11104947,rs11611632,rs353887,rs701100,rs7995074,rs9603756,rs9549215,rs1535682,rs4942308,rs9562578,rs566105,rs1504418,rs9530164,rs9543281,rs9530168,rs6562748,rs11841589,rs9600325,rs7985210,rs982790,rs2209831,rs16947802,rs9518309,rs582322,rs10508158,rs16968045,rs9559436,rs1184774,rs17764769,rs946617,rs17093760,rs217656,rs10134028,rs4904385,rs174519,rs174511,rs174510,rs174504,rs1288742,rs17799178,rs3742672,rs8016966,rs1955614,rs2275595,rs2958272,rs17649182,rs1567074,rs16961283,rs8041381,rs12922641,rs7203853,rs9930735,rs4785322,rs6564809,rs41526051,rs8050818,rs7213911,rs9901316,rs3785624,rs7219975,rs3815073,rs16957364,rs17821703,rs17221329,rs4969058,rs7503887,rs10853282,rs3088182,rs17561133,rs16978159,rs7244157,rs7235487,rs8093745,rs10408164,rs4416143,rs667907,rs202481,rs12480230,rs2224609,rs2423402,rs2072978,rs6030932,rs6018084,rs13042833,rs375980,rs1569307,rs2838699,rs1883472,rs11913594,rs8135343,rs11703828,rs133503,\n";
    	//Hapmap 2
    	std::string SNPId = "rs987435,rs8091955,rs2040704,rs7921545,rs7677859,rs2324520,rs4242682,rs1450428,rs7215008,rs7974633,rs10187056,rs1588040,rs1932366,rs2204738,rs4847428,rs1909338,rs7676617,rs7158108,rs2578669,rs10758940,rs6679430,rs4835141,rs1099968,rs2214965,rs2506898,rs16953500,rs12511245,rs12921822,rs2035247,rs1679012,rs1726254,rs12681671,rs560767,rs17671597,rs2490385,rs1814538,rs12204275,rs7111521,rs7551132,rs3181372,rs2849372,rs2967391,rs2029623,rs519381,rs2463383,rs11563620,rs6035761,rs27162+F786,rs12446781,rs11098948,rs2546001,rs1854935,rs158512,rs2422098,rs277639,rs6698919,rs4791868,rs9866028,rs9595066,rs1484213,rs4705115,rs4877791,rs9821525,rs2673884,rs9931378,rs6926482,rs2631899,rs4789182,rs1437724,rs6546753,rs1942885,rs11130791,rs4713659,rs10998087,rs1437787,rs13086858,rs864386,rs12120383,rs4615248,rs11170991,rs11903376,rs35389,rs6763648,rs931410,rs12641411,rs590616,rs2605419,rs11649653,rs1320385,rs2433354,rs1117382,rs868622,rs7376483,rs2893312,rs4577845,rs735480,rs10814993,rs2000743,rs702032,rs533571,rs2305858,rs1924381,rs10759290,rs10185826,rs2200402,rs39639,rs6897135,rs4787645,rs10851731,rs12542990,rs12036675,rs6451268,rs260699,rs4722760,rs4749305,rs747094,rs12062528,rs542405,rs6468344,rs1986420,rs11085023,rs260700,rs8097206,rs738276,rs260711,rs2700392,rs282162,rs1478446,rs1805972,rs12677218,rs6977118,rs12895262,rs943773,rs4832501,rs6437783,rs7983489,rs6560084,rs12135904,rs7923368,rs1250253,rs738987,rs7689609,rs2228511,rs11691947,rs7956796,rs6534999,rs2500090,rs2907599,rs4825,rs1419138,rs2675345,rs260705,rs2002739,rs260709,\n";
    	//std::cout << line1;
    	//std::cout << line2;
    	std::vector<size_t>posvector1;
    	posvector1.push_back(-1);
    	std::vector<size_t>posvector2;
    	posvector2.push_back(-1);

    	std::vector<std::string> treevector;
    	std::vector<size_t>postree;
    	postree.push_back(-1);
    	std::vector<int> dataposvector;

    	for (size_t i = 0; i < SNPId.length(); ++i)
    	{
    		//std::cout << str.at(i);
    		if (SNPId.at(i) == ','){
    			postree.push_back(i);
    		}
    	}
    	postree.push_back(SNPId.find(linebreak) - linebreak.length());
    	for (int j = 0; j < (postree.size() - 2); j++){
    		treevector.push_back(SNPId.substr(postree[j] + delimiter.length(), postree[j + 1] - postree[j] - 1));
    	}

    	for (size_t i = 0; i < line1.length(); ++i)
    	{
    		//std::cout << str.at(i);
    		if (line1.at(i) == ','){
    				posvector1.push_back(i);
    			}
    	}
    	posvector1.push_back(line1.find(linebreak)-linebreak.length());
    	for (int j = 0; j < (posvector1.size()-2); j++){
    		//myvectorinitial[0].push_back(line1.substr(posvector1[j] + delimiter.length(), posvector1[j + 1] - posvector1[j] - 1));
    		//if (inTheTreeOrNot(treevector, line1.substr(posvector1[j] + delimiter.length(), posvector1[j + 1] - posvector1[j] - 1))){
    		std::vector<std::string>::iterator it;
    	  it = find (treevector.begin(), treevector.end(), (line1.substr(posvector1[j] + delimiter.length(), posvector1[j + 1] - posvector1[j] - 1)));
    		if (it != treevector.end()){
    			dataposvector.push_back(j);
    			myvector[0].push_back(line1.substr(posvector1[j] + delimiter.length(), posvector1[j + 1] - posvector1[j] - 1));
    		}
    	}

    	for (size_t i = 0; i < line2.length(); ++i)
    	{
    		//std::cout << str.at(i);
    		if (line2.at(i) == ','){
    			posvector2.push_back(i);
    		}
    	}
    	posvector2.push_back(line2.find(linebreak) - linebreak.length());
    	for (int j = 0; j < (posvector2.size() - 2); j++){
    		myvectorinitial[1].push_back(line2.substr(posvector2[j] + delimiter.length(), posvector2[j + 1] - posvector2[j] - 1));
    	}
    	for (int k = 0; k <= dataposvector.size() - 1; k++){
    		//myvector[0].push_back(myvectorinitial[0][dataposvector[k]]);
    		myvector[1].push_back(myvectorinitial[1][dataposvector[k]]);
    	}

    	return myvector;
    }

    void getJSONResult(VS result){
      //use boost property_tree lib to report final result
      using boost::property_tree::ptree;
      using boost::property_tree::basic_ptree;
    	int numEUR = 0;
    	int numCHN = 0;
    	int numAMR = 0;
    	int numJPN = 0;
    	int numNoValue = 0;
    	for (int i = 0; i <= (result.size() - 1); i++){
    		if (result[i] == "1"){ numEUR++; }
    		else if (result[i] == "9"){ numCHN++; }
    		else if (result[i] == "7"){ numAMR++; }
    		else if (result[i] == "6"){ numJPN++; }
    		else if (result[i] == "No Value"){ numNoValue++; }
    	}
    	std::cout << "EUR: " << numEUR << std::endl;
    	std::cout << "CHN: " << numCHN << std::endl;
    	std::cout << "AMR: " << numAMR << std::endl;
    	std::cout << "JPN: " << numJPN << std::endl;
    	std::cout << "NoValue: " << numNoValue << std::endl;
    	if ((numEUR >= numCHN) && (numEUR >= numAMR) && (numEUR >= numJPN))
    		std::cout << "This is EUR." << std::endl;
    	if ((numEUR <= numCHN) && (numCHN >= numAMR) && (numCHN >= numJPN))
    		std::cout << "This is CHN." << std::endl;
    	if ((numAMR >= numCHN) && (numEUR <= numAMR) && (numAMR >= numJPN))
    		std::cout << "This is AMR." << std::endl;
    	if ((numJPN >= numCHN) && (numJPN >= numAMR) && (numEUR <= numJPN))
    		std::cout << "This is JPN." << std::endl;
    }
  }
}

#endif
